(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3e18"],{"5f3d":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.diagramId?s("div",{staticStyle:{margin:"-1px 0px 0px 0px"},attrs:{id:"shareDiagram"}},[s("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:t.diagramId,expression:"diagramId"}],attrs:{disabled:!t.publicState},on:{click:function(e){t.modalShow=!t.modalShow}}},[s("font-awesome-icon",{attrs:{icon:"share"}}),t._v(" "),null==t.showText||1==t.showText?s("span",[t._v(" "+t._s(t.$t("share.share"))+" ")]):t._e()],1),s("b-modal",{attrs:{"hide-footer":t.disableAllSecuries,size:"lg","no-fade":"","ok-only":"","ok-title":t.okButtonName,id:t.diagramId+1,title:t.$t("share.shareprocess")},on:{hidden:t.handleHidden,ok:t.handleOk},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var n=e.ok;return[t.needUpdate?s("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(e){return t.handleCancel()}}},[t._v(" "+t._s(t.$t("share.cancel"))+" ")]):t._e(),s("b-button",{attrs:{id:"v-step-15",variant:"primary"},on:{click:function(t){return n()}}},[t._v(" "+t._s(t.okButtonName)+" ")])]}}],null,!1,3370967705),model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[s("h5",[t._v(t._s(t.$t("direct-link")))]),s("b-form",{attrs:{inline:""}},[s("b-form-input",{staticStyle:{width:"40rem"},attrs:{disabled:"",id:"direct"},model:{value:t.directUrl,callback:function(e){t.directUrl=e},expression:"directUrl"}}),s("b-btn",{staticClass:"ml-2",attrs:{variant:"light"},on:{click:t.copyDirectLink}},[t._v(" "+t._s(t.$t("copy"))+" ")])],1),s("div",{attrs:{id:"people-share"}},[s("h5",[t._v(t._s(t.$t("share.peoples")))]),s("b-alert",{staticClass:"mt-1",attrs:{show:t.needUpdate,variant:"warning"}},[t._v(" "+t._s(t.$t("share.madechanges"))+" ")]),t.needUpdate?t._e():s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("b-form-tags",{attrs:{disabled:t.disableAllSecuries,"tag-variant":"primary",placeholder:t.$t("share.enteremails"),"invalid-tag-text":t.$t("share.invalidemail"),"remove-on-delete":"","input-id":"tags-validation","input-attrs":{"aria-describedby":"tags-validation-help"},state:t.state,"tag-validator":t.tagValidator,separator:" ,;"},on:{"tag-state":t.onTagState},model:{value:t.emails,callback:function(e){t.emails=e},expression:"emails"}}),s("small",{staticClass:"mt-2",attrs:{show:!t.disableAllSecuries,variant:"info"}},[s("em",[t._v(" "+t._s(t.$t("share.invitedfellows")))])])],1),s("b-col",[s("b-dropdown",{staticStyle:{"padding-top":"2px"},attrs:{id:"v-step-13",disabled:t.disableAllSecuries,block:"",text:t.text,variant:"outline-info"}},[s("b-dropdown-item",{on:{click:function(e){return t.setSettings("VIEW")}}},[s("font-awesome-icon",{attrs:{icon:"eye"}}),t._v(" "+t._s(t.$t("share.view")))],1),s("b-dropdown-item",{on:{click:function(e){return t.setSettings("EDIT")}}},[s("font-awesome-icon",{attrs:{icon:"edit"}}),t._v(" "+t._s(t.$t("share.edit"))+" ")],1)],1)],1)],1)],1),null!=t.currentUsersSettings&&t.currentUsersSettings.length>0?s("div",{staticClass:"mt-1",attrs:{id:"current-settings"}},[s("b-table",{attrs:{bordered:"",small:"",fields:t.fields,"table-variant":"light",hover:"",items:t.currentUsersSettings},scopedSlots:t._u([{key:"cell(userEmail)",fn:function(e){return[s("small",[s("font-awesome-icon",{attrs:{icon:e.item.currentUser?"user":"envelope-open"}}),t._v(" "+t._s(e.item.userEmail)+" "),s("br"),null!=e.item.createdBy?s("i",[t._v(" "+t._s(t.$t("created-by"))+" "+t._s(e.item.createdBy)+" ")]):t._e()],1)]}},{key:"cell(settings)",fn:function(e){return[s("b-form-select",{attrs:{options:t.options,size:"sm"},on:{change:t.handleChange},model:{value:e.item.settings,callback:function(s){t.$set(e.item,"settings",s)},expression:"data.item.settings"}})]}},{key:"cell(delete)",fn:function(e){return[s("b-btn",{attrs:{block:"",size:"sm",variant:"link"},on:{click:function(s){return t.deleteSecure(e.item.id)}}},[s("font-awesome-icon",{attrs:{icon:"times"}})],1)]}}],null,!1,2967945407)})],1):t._e(),s("div",{attrs:{id:"anon-share"}},[s("small",{staticClass:"mt-2",attrs:{show:!t.disableAllSecuries,variant:"info"}},[s("b-form-checkbox",{attrs:{size:"lg",switch:""},model:{value:t.checkboxAnonSettings,callback:function(e){t.checkboxAnonSettings=e},expression:"checkboxAnonSettings"}},[s("h5",[t._v(t._s(t.$t("anonumous-access")))])])],1),s("b-alert",{staticClass:"mt-2",attrs:{variant:"danger",show:"VIEW"==t.selectedAnonSettings}},[t._v(" "+t._s(t.$t("any-person-can-see-process"))+" ")])],1),s("h5",[t._v(" "+t._s(t.$t("code-for-embedded")))]),s("b-form-textarea",{attrs:{id:"v-step-14",disabled:"",rows:"3"},model:{value:t.iframeUrl,callback:function(e){t.iframeUrl=e},expression:"iframeUrl"}}),s("b-alert",{staticClass:"mt-3",attrs:{variant:"white",show:!t.payedPlan}},[s("h5",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("star-free-trial-from-share"))+" ")]),s("b-btn",{attrs:{variant:"success",block:"",target:"_blank",to:"/app/team"}},[t._v(" "+t._s(t.$t("and-start-your-free-trial"))+" ")])],1)],1),s("b-modal",{attrs:{size:"xl","hide-footer":"",title:t.$t("you-reach-share-limit-upgrade")},model:{value:t.showUpdgradePlan,callback:function(e){t.showUpdgradePlan=e},expression:"showUpdgradePlan"}},[s("div",{staticStyle:{"margin-top":"-80px"}},[s("upgrade-view")],1)])],1):t._e()},a=[],i=s("2909"),r=(s("d3b7"),s("3ca3"),s("ddb0"),s("caad"),s("2532"),s("159b"),s("ac1f"),s("00b4"),s("c21c")),o=(s("6dfc"),{name:"ShareDiagramOrVersion",props:["diagramId","version","showText","bpmUrl"],components:{upgradeView:function(){return s.e("chunk-282a6536").then(s.bind(null,"e4bf"))}},data:function(){return{checkboxAnonSettings:!1,allowFork:!1,modalShow:!1,validTags:null,invalidTags:null,duplicateTags:null,showUpdgradePlan:!1,selectedSettings:"VIEW",currentSettings:[],disableAllSecuries:!1,needUpdate:!1,currentUsersSettings:[],text:this.$t("access-level"),anontext:this.$t("anon-access-level"),options:[{value:"VIEW",text:this.$t("share.view")},{value:"EDIT",text:this.$t("share.edit")}],selectedAnonSettings:null,tag:"",fields:[{key:"userEmail",label:this.$t("email")},{key:"settings",label:this.$t("access")},{key:"delete",label:""}],emails:[],reg:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,24}))$/}},methods:{onTagState:function(t,e,s){this.validTags=t,this.invalidTags=e,this.duplicateTags=s},handleCancel:function(){this.needUpdate=!1,this.getCurrentSettings()},handleHidden:function(){this.$emit("hidden")},handleChange:function(){this.needUpdate=!0},deleteSecure:function(t){var e=this;confirm(this.$t("are-you-really-want-delete-access"))&&r["a"].delete("/diagram/secure/"+t).then((function(){e.getCurrentSettings()}))},fromSettingsToText:function(t){return"NONE"==t?this.$t("no-access"):"VIEW"==t?this.$t("share.view"):"EDIT"==t?this.$t("share.edit"):void 0},fromSettingsToIcon:function(t){return"NONE"==t?"times-circle":"VIEW"==t?"eye":"EDIT"==t?"edit":void 0},handleOk:function(){var t=this;if(0==this.needUpdate){var e,s={diagramId:this.diagramId,userEmails:this.emails,settings:this.selectedSettings,anonymousSettings:!1};if(this.validTags.length>0)(e=s.userEmails).push.apply(e,Object(i["a"])(this.validTags));r["a"].post("/diagram/secure/",s).then((function(){t.getCurrentSettings()})).catch((function(e){e.response.data.details.includes("upgrade")&&(t.showUpdgradePlan=!0),t.errorMessage(e.response.data.details)}))}if(1==this.needUpdate){var n=this.currentUsersSettings.length,a=1;this.currentUsersSettings.forEach((function(e){var s={diagramId:t.diagramId,userEmails:[e.userEmail],settings:e.settings,anonymousSettings:!1};r["a"].post("/diagram/secure/",s).then((function(){})),n==a&&t.getCurrentSettings()}))}},getCurrentSettings:function(){var t=this,e={cache:{ignoreCache:!0}};r["a"].get("/diagram/secure/"+this.diagramId,e).then((function(e){t.currentSettings=[],t.currentSettings=e.data,t.currentUsersSettings=[],t.currentSettings.forEach((function(e){1==e.anonymousSettings&&null==e.userEmail&&(t.selectedAnonSettings=e.settings,"NONE"==t.selectedAnonSettings&&(t.anontext=t.$t("only-specific-have-access")),"VIEW"==t.selectedAnonSettings&&(t.checkboxAnonSettings=!0,t.anontext=t.$t("share.viewrights")),"EDIT"==t.selectedAnonSettings&&(t.anontext=t.$t("any-person-can-edit-process"))),null!=e.userEmail&&t.currentUsersSettings.push(e)}))})).catch((function(){t.disableAllSecuries=!0}))},clipboardSuccessHandler:function(){this.$bvToast.toast(this.$t("link-in-buffer"),{title:this.$t("coped"),toaster:"b-toaster-bottom-center",variant:"success",solid:!0})},setAnonSettings:function(t){this.selectedAnonSettings=t,"NONE"==this.selectedAnonSettings&&(this.anontext=this.$t("only-specific-have-access")),"VIEW"==this.selectedAnonSettings&&(this.anontext=this.$t("share.viewrights")),"EDIT"==this.selectedAnonSettings&&(this.anontext=this.$t("any-person-can-edit-process")),this.putAnonSettings()},putAnonSettings:function(){var t=this,e={diagramId:this.diagramId,anonymousSettings:!0,settings:this.selectedAnonSettings};r["a"].post("/diagram/secure/",e).then((function(){var e;t.successMessage();var s=event.clipboardData||window.clipboardData||(null===(e=event.originalEvent)||void 0===e?void 0:e.clipboardData)||navigator.clipboard;s.writeText(t.directUrl),"NONE"!=t.selectedAnonSettings&&t.clipboardSuccessHandler()})).catch((function(e){e.response.data.details.includes("upgrade")&&(t.showUpdgradePlan=!0),t.errorMessage(e.response.data.details)}))},copyDirectLink:function(){var t,e=event.clipboardData||window.clipboardData||(null===(t=event.originalEvent)||void 0===t?void 0:t.clipboardData)||navigator.clipboard;e.writeText(this.directUrl+"?embedded=true"),this.clipboardSuccessHandler()},successMessage:function(){this.$bvToast.toast(this.$t("access-setuped"),{title:this.$t("success"),variant:"success",toaster:"b-toaster-bottom-center",solid:!0})},errorMessage:function(t){var e=this.$t("access-not-setuped");null!=t&&(e=t),this.$bvToast.toast(e,{title:this.$t("error"),variant:"warning",toaster:"b-toaster-bottom-center",solid:!0})},setSettings:function(t){this.selectedSettings=t,"VIEW"==this.selectedSettings&&(this.text=this.$t("share.view")),"EDIT"==this.selectedSettings&&(this.text=this.$t("share.edit"))},tagValidator:function(t){return""==t?"":!!this.reg.test(t)},handleAdding:function(t){this.isEmailValid(t.tag.text)&&t.addTag()}},mounted:function(){null!=this.$route.query&null!=this.$route.query.shareLink&&(this.modalShow="true"==this.$route.query.shareLink)},watch:{checkboxAnonSettings:function(t,e){t&&this.setAnonSettings("VIEW"),t||this.setAnonSettings("NONE")},tags:function(){this.dirty=!0},modalShow:function(t){1==t&&this.getCurrentSettings()},emails:function(){}},computed:{isAuthenticated:function(){return this.$store.getters.isAuthenticated},payedPlan:function(){return"null"!=this.$store.getters.getPlan&&"Personal"!=this.$store.getters.getPlan},okButtonName:function(){return 1==this.needUpdate?this.$t("save-changes"):this.$t("grant-access")},iframeUrl:function(){var t='<iframe src="'+this.directUrl+'?embedded=true" style="border:1px #f2f2f2 none;" name="extAdmin" scrolling="yes" frameborder="1"  height="1000" width="100%" allowfullscreen></iframe>';return t},publicState:function(){return this.$store.getters.getCurrentDiagramPublicState},directUrl:function(){var t="diagram";return this.bpmUrl&&(t="bpm"),window.location.origin+"/app/"+t+"/"+this.diagramId},state:function(){return this.dirty?this.tags.length>1&&this.tags.length<10:null}}}),l=o,c=s("2877"),d=Object(c["a"])(l,n,a,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0d3e18.9ed335dd.js.map