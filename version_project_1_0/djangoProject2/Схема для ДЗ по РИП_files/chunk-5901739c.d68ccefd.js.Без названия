(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5901739c"],{8672:function(t,e,a){"use strict";a("dbbb")},a1c8:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container1"},[n("b-container",[n("b-row",[n("b-col",[n("b-card",{attrs:{"body-class":"text-center"}},[n("h3",[t._v(t._s(t.$t("common.login")))]),n("hr"),n("b-form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[n("b-form-group",{attrs:{id:"input-group-2",label:t.$t("email"),"label-for":"input-2"}},[n("b-form-input",{class:t.status(t.$v.username),attrs:{id:"input-2"},model:{value:t.$v.username.$model,callback:function(e){t.$set(t.$v.username,"$model",e)},expression:"$v.username.$model"}})],1),n("b-form-group",{attrs:{id:"input-group-3",label:t.$t("common.password"),"label-for":"input-3"}},[n("b-form-input",{class:t.status(t.$v.password),attrs:{id:"input-3",type:"password"},model:{value:t.$v.password.$model,callback:function(e){t.$set(t.$v.password,"$model",e)},expression:"$v.password.$model"}})],1),n("b-btn-group",[t.baseRegisterEnabled?n("b-button",{attrs:{variant:"primary",type:"submit",disabled:"PENDING"===t.submitStatus}},[t._v(" "+t._s(t.loginButtonName)+" ")]):t._e(),n("b-form",{on:{submit:function(e){return e.preventDefault(),t.redirectToLoginPageKeycloak.apply(null,arguments)}}},[t.keycloakEnabled?n("b-button",{staticStyle:{"margin-left":"5px"},attrs:{variant:"dark",type:"submit",disabled:"PENDING"===t.submitStatus||0==t.license}},[t._v(t._s(t.signInText)+" ")]):t._e()],1)],1),n("br"),n("b-checkbox",{model:{value:t.license,callback:function(e){t.license=e},expression:"license"}},[n("router-link",{attrs:{to:"/license"}},[t._v(" "+t._s(t.$t("auth.signup.agree")))])],1),t.returnSettingsValue("showRegistraton")?n("small",[n("router-link",{attrs:{to:"/app/signup"}},[t._v(" "+t._s(t.$t("auth.signin.nouser"))+" ")])],1):t._e(),n("br"),t.returnSettingsValue("showRegistraton")?n("small",[n("router-link",{attrs:{to:"/app/requestPasswordRecover"}},[t._v(" "+t._s(t.$t("auth.signin.restorepassword"))+" ")])],1):t._e()],1)],1)],1),n("b-col",{attrs:{sm:"5","offset-sm":"2",md:"6","offset-md":"0"}},[n("img",{staticClass:"mx-auto img-fluid  ",attrs:{src:a("a42e")}})])],1)],1)],1)},s=[],r=(a("7db0"),a("d3b7"),a("b0c0"),a("96cf"),a("c21c")),o=a("b5ae"),i=a("2b0e"),u={name:"TheSignIn",data:function(){return{license:!0,username:null,password:null,submitStatus:null,settings:[],keycloakEnabled:!0,baseRegisterEnabled:"true",signInText:"Войти через соц.сети"}},validations:{username:{required:o["required"]},password:{required:o["required"],minLength:Object(o["minLength"])(6)}},methods:{returnSettingsValue:function(t){try{var e=this.settings.find((function(e){return e.name===t})).value;return"true"==e||"false"!=e&&e}catch(a){return null}},status:function(t){return{error:t.$error,dirty:t.$dirty}},submit:function(){var t=this;this.$v.$touch(),this.$v.$invalid?this.submitStatus="ERROR":(this.login(),this.submitStatus="PENDING",setTimeout((function(){t.submitStatus="OK"}),500))},login:function(){var t=this,e=null;null!==localStorage.getItem("stormLocale")&&(e=localStorage.getItem("stormLocale"));var a={username:this.username,password:this.password,locale:e};r["a"].post("/auth/signin",a).then((function(e){t.$store.dispatch("login",{token:e.data.accessToken,roles:e.data.authorities,username:e.data.username,inTeam:e.data.inTeam,teamId:e.data.teamId,teamName:e.data.teamName,plan:e.data.plan,fullAccess:e.data.fullAccess,validTo:e.data.validTo,enabledIntegration:e.data.enabledIntegration,license:e.data.currentLicense}).then((function(){t.$route.query&&t.$route.query.redirectUrl?t.$router.push(t.$route.query.redirectUrl):t.$router.push("/app/home")}))}),(function(e){t.errorInfo(t.$t("error"),e.response.data.message)})).catch((function(){t.errorInfo(t.$t("error"),t.$t("sorry"))}))},redirectToLoginPageKeycloak:function(){i["default"].$keycloak.login()},startup:function(){var t=this;void 0!==i["default"].$keycloak.token&&(this.submitStatus="PENDING",setTimeout((function(){t.loginKeycloak(),t.submitStatus="OK"}),2e3))},loginKeycloak:function(){var t=this,e=null;null!==localStorage.getItem("ad_attribution")&&(e=localStorage.getItem("ad_attribution"));var a={username:"username",password:"password",locale:null,ad_attribution:e};r["a"].post("/auth/signin/",a,{params:{provider:"Keycloak"},headers:{"keycloak-token":i["default"].$keycloak.token,"Content-Type":"application/json"}}).then((function(e){t.$store.dispatch("login",{token:e.data.accessToken,roles:e.data.authorities,username:e.data.username,inTeam:e.data.inTeam,teamId:e.data.teamId,teamName:e.data.teamName,fullAccess:e.data.fullAccess,plan:e.data.plan,validTo:e.data.validTo,enabledIntegration:e.data.enabledIntegration,license:e.data.currentLicense}).then((function(){t.$router.push("/app/home")}))}),(function(e){t.errorInfo(t.$t("error"),e.response.data.message)})).catch((function(){t.errorInfo(t.$t("error"),t.$t("sorry"))}))}},computed:{loginButtonName:function(){return 1==this.returnSettingsValue("showCustomLoginButtonName")?this.returnSettingsValue("CustomLoginButtonName"):this.$t("common.login")}},beforeMount:function(){var t=this;this.startup(),r["a"].get("/license").then((function(e){t.baseRegisterEnabled=e.data.enableBaseRegister,t.signInText=e.data.ssoLoginText})),r["a"].get("/admin/global-settings").then((function(e){t.settings=e.data}))},mounted:function(){if(null!=this.$route.query&&null!=this.$route.query.reasonToRedirect){var t=this.$route.query.reasonToRedirect;"security"==t&&this.$bvToast.toast(this.$t("why-need-to-relogin"),{title:this.$t("you-need-to-relogin"),toaster:"b-toaster-bottom-center",variant:"danger",noAutoHide:!0,solid:!0})}}},l=u,c=(a("8672"),a("2877")),d=Object(c["a"])(l,n,s,!1,null,"7e7b0ae9",null);e["default"]=d.exports},a42e:function(t,e,a){t.exports=a.p+"static/img/undraw_secure_login_pdn4.665f2c8f.svg"},dbbb:function(t,e,a){}}]);
//# sourceMappingURL=chunk-5901739c.d68ccefd.js.map