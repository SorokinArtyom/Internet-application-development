(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-747054c2","chunk-747054c2"],{"2f9a4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-alert",{staticClass:"mt-1",attrs:{variant:"danger",show:!e.payedTeamPlan}},[e._v(" "+e._s(e.$t("generation-payed-plan"))+" "),a("br"),a("router-link",{attrs:{to:"/app/upgrade"}},[e._v(" "+e._s(e.$t("improve-your-plan"))+" ")])],1),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.template-generate",modifiers:{"template-generate":!0}}],attrs:{disabled:!e.payedTeamPlan,block:"",variant:"light"}},[a("font-awesome-icon",{attrs:{icon:"file"}}),e._v(" "+e._s(e.$t("generate-template"))+" ")],1),a("b-modal",{ref:"my-modal",attrs:{"ok-title":"Скачать","cancel-title":"Отменить",title:e.$t("generate-template"),id:"template-generate"},on:{ok:function(t){return e.generateMyTempate()}}},[a("create-template",{on:{uploaded:e.getMyTemplates}}),a("label",{attrs:{for:"selectField"}},[e._v(" "+e._s(e.$t("choose-template"))+" ")]),a("b-form-select",{attrs:{id:"selectField","value-field":"id","text-field":"name","select-size":4,options:e.templateList,size:"sm"},model:{value:e.selectedTemplate,callback:function(t){e.selectedTemplate=t},expression:"selectedTemplate"}})],1)],1)},l=[],i=(a("d3b7"),a("3ca3"),a("ddb0"),a("b0c0"),a("159b"),a("7db0"),a("2b3d"),a("9861"),a("1ef9")),o=a("c21c"),r={props:["diagramId","diagramBody"],name:"TemplateGenerate",components:{createTemplate:function(){return a.e("chunk-2d2086c9").then(a.bind(null,"a576"))}},data:function(){return{templateList:[],preventCache:{cache:{ignoreCache:!0}},selectedTemplate:null,moddle:null,elementsOfDiagram:null,flowElements:[]}},computed:{payedTeamPlan:function(){return this.$store.getters.getCurrentTeamPlan}},mounted:function(){this.getMyTemplates(),this.initiateElementsOfDiagrams()},methods:{initiateOrGetModdle:function(){var e=this;return new Promise((function(t,a){null==e.moddle&&(e.moddle=new i["a"]),t(e.moddle)}))},initiateElementsOfDiagrams:function(){var e=this,t=this;return new Promise((function(a,n){null!=t.diagramBody?e.initiateOrGetModdle().then((function(e){e.fromXML(t.diagramBody).then((function(e){t.elementsOfDiagram=e.rootElement;var n=[];for(var l in e.elementsById)if("bpmn:Participant"==e.elementsById[l].$type&&"processRef"in e.elementsById[l]){var i={processId:e.elementsById[l].processRef.id,name:e.elementsById[l].name};n.push(i)}t.elementsOfDiagram.rootElements.forEach((function(e){"bpmn:Process"==e.$type&&"flowElements"in e&&e.flowElements.length>0&&e.flowElements.forEach((function(e){try{e["activityPoolName"]=n.find((function(t){return t.processId==e.$parent.id})).name}catch(a){e["activityPoolName"]=null}t.flowElements.push(e)}))})),a()}))})):a()}))},getMyTemplates:function(){var e=this;this.templateList=[],o["a"].get("/document-template",this.preventCache).then((function(t){e.templateList=t.data}))},generateMyTempate:function(){this.selectedTemplate,this.flowElements,this.diagramId;Object(o["a"])({url:"/document-template/generate",method:"post",data:{templateId:this.selectedTemplate,flowElements:this.flowElements,diagramId:this.diagramId},responseType:"arraybuffer"}).then((function(e){var t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),a=window.URL.createObjectURL(t);window.open(a)}))}}},s=r,m=a("2877"),d=Object(m["a"])(s,n,l,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-747054c2.f4ffad85.js.map