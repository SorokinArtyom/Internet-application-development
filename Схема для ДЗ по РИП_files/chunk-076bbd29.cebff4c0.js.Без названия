(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-076bbd29"],{"16e4":function(e,t,n){"use strict";n("d0c8")},"1b73":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-modal",{attrs:{id:"modal-sm","hide-header":"","hide-footer":"",title:e.$t("delete-folder-with-content")},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[e.selectedNode?a("h5",[e._v(" "+e._s(e.$t("are-you-really-want-delete-folder"))+" "),a("i",[e._v(e._s(e.selectedNode.text)+" ")]),a("b",[e._v(e._s(e.$t("with-all-content")))]),e._v("? "),a("hr"),e._v(" "+e._s(e.$t("enter-folder-name"))+" "),a("b-input",{model:{value:e.deleteName,callback:function(t){e.deleteName=t},expression:"deleteName"}}),a("b-btn",{staticClass:"mt-2",attrs:{disabled:e.selectedNode.text!=e.deleteName,variant:"danger",block:""},on:{click:e.onRealDel}},[e._v(" "+e._s(e.$t("delete-all-folder-with-all-content"))+" ")])],1):e._e()]),e.isInTeam?a("div",[a("b-form-input",{attrs:{placeholder:this.$t("search")},on:{"v-on:keyup":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterArray.apply(null,arguments)}},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}}),a("b-btn-group",[a("b-btn",{staticClass:"mt-1",attrs:{size:"sm",variant:"light"},on:{click:e.onAddNode}},[a("font-awesome-icon",{attrs:{icon:"plus"}})],1),a("b-btn",{attrs:{size:"sm",variant:"link"},on:{click:e.changeExpand}},[e._v(" "+e._s(e.expand?e.$t("Collapse"):e.$t("Expand"))+" ")])],1),a("new-tree",{attrs:{eachDroppable:e.findDroppable,draggingNodePositionMode:"mouse",ondragend:e.MoveNewComponent,value:e.folderTree},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,o=t.tree,i=t.path;return a("section",{on:{mouseover:function(t){e.upHere=n}}},[a("div",{staticClass:"node-style"},[null!=n.diagramId?a("font-awesome-icon",{attrs:{icon:"file"}}):e._e(),null==n.diagramId?a("font-awesome-icon",{style:{color:"#adb5bd"},attrs:{icon:e.calculateFolderImage(null,n.$folded,n.children,n.id)},on:{click:function(t){return e.changeFold(o,n,i)}}}):e._e(),a("span",{staticClass:"mt-1 ml-1",attrs:{id:n.id.toString()}},[e._v(e._s(n.text))]),n.isLeaf?a("b-tooltip",{attrs:{target:n.id.toString(),triggers:"hover"}},[e._v(" "+e._s(e._f("moment")(n.updatedOn,"lll"))+" "+e._s(n.updatedBy)+" ")]):e._e(),n.waitsecurecount>0?a("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-2",attrs:{title:e.$t("direct-access-secure-not-accepted"),variant:"info"}},[a("font-awesome-icon",{attrs:{icon:"clock"}}),e._v(" "+e._s(n.waitsecurecount)+" ")],1):e._e(),n.activesecurecount>0?a("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-2",attrs:{title:e.$t("direct-access-secure"),variant:"warning"}},[a("font-awesome-icon",{attrs:{icon:"lock"}}),e._v(" "+e._s(n.activesecurecount)+" ")],1):e._e(),e.upHere.id==n.id?a("b-btn-group",{staticClass:"ml-3",attrs:{size:"sm"}},[n.isLeaf?a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.bottomleft",modifiers:{hover:!0,bottomleft:!0}}],attrs:{title:e.$t("go-to-diagram"),variant:"light"},on:{click:function(t){return e.onClick(n)}}},[a("font-awesome-icon",{attrs:{icon:"forward"}})],1):e._e(),n.isLeaf||null==n||null==n.id?e._e():a("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal",value:n.id.toString(),expression:"node.id.toString()"},{name:"b-tooltip",rawName:"v-b-tooltip.hover.bottomleft",modifiers:{hover:!0,bottomleft:!0}}],attrs:{title:e.$t("edit"),variant:"light"}},[a("font-awesome-icon",{attrs:{icon:"edit"}})],1),null!=n.id&&null!=n?a("b-modal",{ref:"btnShow",attrs:{id:n.id.toString(),title:e.$t("rename-folder")},on:{hide:e.getFolders,ok:function(t){return e.onChangeName(n)}}},[a("b-form-input",{attrs:{autofocus:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onChangeName(n)}},model:{value:n.text,callback:function(t){e.$set(n,"text",t)},expression:"node.text"}})],1):e._e(),a("b-btn",{attrs:{variant:"light"}},[n.isLeaf?a("share",{key:e.shareKey+n.diagramId,attrs:{showText:!1,diagramId:n.diagramId},on:{hidden:e.handleHiddenShare}}):e._e(),n.isLeaf?e._e():a("share-folder",{key:e.shareKey+n.id,attrs:{showText:!1,folderId:n.id},on:{hidden:e.handleHiddenShare}})],1),a("b-btn",{attrs:{variant:"danger"},on:{click:function(t){return e.onDel(n)}}},[a("font-awesome-icon",{attrs:{icon:"trash"}})],1)],1):e._e()],1)])}}],null,!1,326912277)})],1):e._e(),e.isInTeam?e._e():a("div",[a("h3",[e._v(" "+e._s(e.$t("folder-only-for-team")))]),a("img",{staticClass:" mt-5 img-min-height mx-auto img-fluid  d-block",attrs:{src:n("60a9")}}),a("b-btn",{staticClass:"mt-5",attrs:{block:"",size:"lg",variant:"outline-success",to:"/app/profile/"}},[a("font-awesome-icon",{attrs:{icon:"user"}}),e._v(" "+e._s(e.$t("invite-team"))+" ")],1)],1)],1)},o=[],i=(n("d3b7"),n("3ca3"),n("ddb0"),n("e9c4"),n("7db0"),n("caad"),n("2532"),n("159b"),n("25f0"),n("b0c0"),n("c21c")),r=n("94dd"),s={name:"TreeView",components:{Share:function(){return Promise.all([n.e("chunk-2d0d3e18"),n.e("chunk-306115dd")]).then(n.bind(null,"5f3d"))},ShareFolder:function(){return n.e("chunk-2d2266e6").then(n.bind(null,"e940"))},newTree:r["c"].mixPlugins([r["a"],r["b"]])},data:function(){return{folderTree:[],userInput:null,newTree:{},name:"",shareKey:0,team:!0,activeTab:"my",upHere:!1,foldedStatus:[],expand:!0,folders:null,deleteName:"",showModal:!1,isLoading:!1,selectedNode:null,diagramIdForRename:null,tree:null}},mounted:function(){null!=localStorage.getItem("storm-expand")&&(this.expand="true"===localStorage.getItem("storm-expand")),null!=localStorage.getItem("activeTab")&&(this.activeTab=localStorage.getItem("activeTab"),"my"==this.activeTab&&(this.team=!1),"team"==this.activeTab&&(this.team=!0)),null!=localStorage.getItem("storm-foldStatus")&&(this.foldedStatus=JSON.parse(localStorage.getItem("storm-foldStatus"))),this.getFolders(!0,!1),this.checkIamInTeam()},beforeDestroy:function(){localStorage.setItem("storm-foldStatus",JSON.stringify(this.foldedStatus))},computed:{isInTeam:function(){return this.$store.getters.getInTeam},plan:function(){return this.$store.getters.getPlan}},methods:{calculateFolderImage:function(e,t,n,a){return 0==n.length?"folder-minus":1==t?"folder":"folder-open"},needToFold:function(e){if(null==localStorage.getItem("storm-foldStatus"))return!1;for(var t=this.foldedStatus,n=0;n<t.length;n++)if(t[n].id==e)return t[n].status},handleHiddenShare:function(){this.shareKey=this.shareKey+1},changeFold:function(e,t,n){if(e.toggleFold(t,n),0==this.foldedStatus.length){var a={id:t.id,status:t.$folded};this.foldedStatus.push(a)}if(this.foldedStatus.length>0){for(var o=0;o<this.foldedStatus.length;o++)if(t.id==this.foldedStatus[o].id){this.foldedStatus[o].status=t.$folded;break}if(!this.foldedStatus.find((function(e){return e.id===t.id}))){var i={id:t.id,status:t.$folded};this.foldedStatus.push(i)}}},findDroppable:function(e,t,n){if(Array.isArray(e)&&e.length){var a=t.getNodeByPath(e);if(!a.isLeaf)return!0;if(a.isLeaf)return!1}return!0},style:function(e,t){return e.id==t.id?"opacity: 100":"opacity: 0"},changeExpand:function(){this.expand=!this.expand,localStorage.setItem("storm-expand",this.expand),1==this.expand&&(Object(r["e"])(this.folderTree),localStorage.removeItem("storm-expand"),this.foldedStatus=[]),0==this.expand&&Object(r["d"])(this.folderTree)},checkIamInTeam:function(){var e=this;i["a"].get("/auth/inTeam").then((function(t){e.$store.commit("setInTeam",t.data)}))},filterArray:function(){""!=this.userInput&&null!=this.userInput||this.getFolders();var e=this.userInput,t=this.filterData(this.folderTree,(function(t){return t.text.includes(e)}));this.folderTree=t,Object(r["e"])(this.folderTree)},filterData:function(e,t){var n=this;return e?e.reduce((function(e,a){var o=null;if(t(a))o=Object.assign({},a);else if(null!=a.children){var i=n.filterData(a.children,t);i.length>0&&(o=Object.assign({},a,{children:i}))}return o&&e.push(o),e}),[]):null},getFolders:function(){this.getClearFolders().then((function(e){}))},putRandomId:function(e){e.isLeaf||(e.$folded=this.needToFold(e.id))},getClearFolders:function(){var e=this;return new Promise((function(t,n){e.isLoading=!0;var a={cache:{ignoreCache:!0}};i["a"].get("/folder/new",a).then((function(n){n.data.forEach((function(t){e.putRandomId(t)})),e.folderTree=n.data,e.isLoading=!1,t()}))}))},randomInteger:function(){var e=9e6,t=9e7,n=e+Math.random()*(t+1-e);return Math.floor(n)},onDel:function(e){var t=this;e.children.length>0&&!e.isLeaf&&(this.showModal=!0,this.selectedNode=e),0!=e.children||e.isLeaf||i["a"].delete("/folder/"+e.id).then((function(e){t.getFolders(!1,!0)})),e.isLeaf&&confirm(this.$t("are-you-really-want-delete-process"))&&i["a"].delete("/diagram/"+e.diagramId).then((function(){t.getFolders(!1,!0)}))},onRealDel:function(){var e=this,t=this.selectedNode;i["a"].delete("/folder/"+t.id+"?team="+this.team).then((function(t){e.showModal=!1,e.getFolders(!1,!0)}))},onChangeName:function(e){var t=this;i["a"].post("/folder/"+e.id+"/rename?newName="+e.text).then((function(n){t.getFolders(!1,!0),t.$root.$emit("bv::hide::modal",e.id.toString(),"#btnShow")}))},onAddNode:function(e){var t=this,n={name:"New folder",pid:null};null!=e&&(n.pid=e.pid),i["a"].post("/folder",n).then((function(e){t.getFolders(),setTimeout((function(){t.$root.$emit("bv::show::modal",e.data.id.toString(),"#btnShow")}),200)}))},onClick:function(e){e.isLeaf&&this.$router.push("/app/diagram/"+e.diagramId)},addNode:function(){var e=this,t={name:this.name};this.name=null,i["a"].post("/folder?team="+this.team,t).then((function(t){e.getFolders()}))},MoveNewComponent:function(e,t){var n=this;try{var a=t.dragNode,o=t.startTree.getNodeParentByPath(t.targetPath),r=o.id;a.isLeaf||i["a"].post("/folder/move?from="+a.id+"&&to="+r).then((function(e){n.getFolders(null,!0)})),a.isLeaf&&i["a"].post("/diagram/"+a.diagramId+"/move?to="+r).then((function(e){n.getFolders(null,!0)}))}catch(s){this.getFolders()}}}},l=s,d=(n("16e4"),n("2877")),c=Object(d["a"])(l,a,o,!1,null,null,null);t["default"]=c.exports},d0c8:function(e,t,n){}}]);
//# sourceMappingURL=chunk-076bbd29.cebff4c0.js.map